{
    "id": "1814",
    "question": {
        "questionId": "1814",
        "questionFrontendId": "1696",
        "boundTopicId": null,
        "title": "Jump Game VI",
        "titleSlug": "jump-game-vi",
        "content": "<p>You are given a <strong>0-indexed</strong> integer array <code>nums</code> and an integer <code>k</code>.</p>\n\n<p>You are initially standing at index <code>0</code>. In one move, you can jump at most <code>k</code> steps forward without going outside the boundaries of the array. That is, you can jump from index <code>i</code> to any index in the range <code>[i + 1, min(n - 1, i + k)]</code> <strong>inclusive</strong>.</p>\n\n<p>You want to reach the last index of the array (index <code>n - 1</code>). Your <strong>score</strong> is the <strong>sum</strong> of all <code>nums[j]</code> for each index <code>j</code> you visited in the array.</p>\n\n<p>Return <em>the <strong>maximum score</strong> you can get</em>.</p>\n\n<p>&nbsp;</p>\n<p><strong>Example 1:</strong></p>\n\n<pre>\n<strong>Input:</strong> nums = [<u>1</u>,<u>-1</u>,-2,<u>4</u>,-7,<u>3</u>], k = 2\n<strong>Output:</strong> 7\n<strong>Explanation:</strong> You can choose your jumps forming the subsequence [1,-1,4,3] (underlined above). The sum is 7.\n</pre>\n\n<p><strong>Example 2:</strong></p>\n\n<pre>\n<strong>Input:</strong> nums = [<u>10</u>,-5,-2,<u>4</u>,0,<u>3</u>], k = 3\n<strong>Output:</strong> 17\n<strong>Explanation:</strong> You can choose your jumps forming the subsequence [10,4,3] (underlined above). The sum is 17.\n</pre>\n\n<p><strong>Example 3:</strong></p>\n\n<pre>\n<strong>Input:</strong> nums = [1,-5,-20,4,-1,3,-6,-3], k = 2\n<strong>Output:</strong> 0\n</pre>\n\n<p>&nbsp;</p>\n<p><strong>Constraints:</strong></p>\n\n<ul>\n\t<li><code>1 &lt;= nums.length, k &lt;= 10<sup>5</sup></code></li>\n\t<li><code>-10<sup>4</sup> &lt;= nums[i] &lt;= 10<sup>4</sup></code></li>\n</ul>\n",
        "translatedTitle": null,
        "translatedContent": null,
        "isPaidOnly": false,
        "difficulty": "Medium",
        "likes": 2691,
        "dislikes": 92,
        "isLiked": null,
        "similarQuestions": "[{\"title\": \"Sliding Window Maximum\", \"titleSlug\": \"sliding-window-maximum\", \"difficulty\": \"Hard\", \"translatedTitle\": null}, {\"title\": \"Jump Game VII\", \"titleSlug\": \"jump-game-vii\", \"difficulty\": \"Medium\", \"translatedTitle\": null}, {\"title\": \"Jump Game VIII\", \"titleSlug\": \"jump-game-viii\", \"difficulty\": \"Medium\", \"translatedTitle\": null}]",
        "exampleTestcases": "[1,-1,-2,4,-7,3]\n2\n[10,-5,-2,4,0,3]\n3\n[1,-5,-20,4,-1,3,-6,-3]\n2",
        "categoryTitle": "Algorithms",
        "contributors": [],
        "topicTags": [
            {
                "name": "Array",
                "slug": "array",
                "translatedName": null,
                "__typename": "TopicTagNode"
            },
            {
                "name": "Dynamic Programming",
                "slug": "dynamic-programming",
                "translatedName": null,
                "__typename": "TopicTagNode"
            },
            {
                "name": "Queue",
                "slug": "queue",
                "translatedName": null,
                "__typename": "TopicTagNode"
            },
            {
                "name": "Sliding Window",
                "slug": "sliding-window",
                "translatedName": null,
                "__typename": "TopicTagNode"
            },
            {
                "name": "Heap (Priority Queue)",
                "slug": "heap-priority-queue",
                "translatedName": null,
                "__typename": "TopicTagNode"
            },
            {
                "name": "Monotonic Queue",
                "slug": "monotonic-queue",
                "translatedName": null,
                "__typename": "TopicTagNode"
            }
        ],
        "companyTagStats": "{\"3\": [{\"taggedByAdmin\": false, \"name\": \"Uber\", \"slug\": \"uber\", \"timesEncountered\": 6}, {\"taggedByAdmin\": false, \"name\": \"Bloomberg\", \"slug\": \"bloomberg\", \"timesEncountered\": 3}, {\"taggedByAdmin\": false, \"name\": \"tiktok\", \"slug\": \"tiktok\", \"timesEncountered\": 2}, {\"taggedByAdmin\": true, \"name\": \"AQR Capital Management LLC\", \"slug\": \"aqr-capital-management-llc\", \"timesEncountered\": 0}], \"1\": [{\"taggedByAdmin\": false, \"name\": \"Apple\", \"slug\": \"apple\", \"timesEncountered\": 4}, {\"taggedByAdmin\": false, \"name\": \"Amazon\", \"slug\": \"amazon\", \"timesEncountered\": 3}, {\"taggedByAdmin\": false, \"name\": \"Mathworks\", \"slug\": \"mathworks\", \"timesEncountered\": 2}], \"2\": [{\"taggedByAdmin\": false, \"name\": \"LinkedIn\", \"slug\": \"linkedin\", \"timesEncountered\": 2}]}",
        "codeSnippets": [
            {
                "lang": "C++",
                "langSlug": "cpp",
                "code": "class Solution {\npublic:\n    int maxResult(vector<int>& nums, int k) {\n        \n    }\n};",
                "__typename": "CodeSnippetNode"
            },
            {
                "lang": "Java",
                "langSlug": "java",
                "code": "class Solution {\n    public int maxResult(int[] nums, int k) {\n        \n    }\n}",
                "__typename": "CodeSnippetNode"
            },
            {
                "lang": "Python",
                "langSlug": "python",
                "code": "class Solution(object):\n    def maxResult(self, nums, k):\n        \"\"\"\n        :type nums: List[int]\n        :type k: int\n        :rtype: int\n        \"\"\"\n        ",
                "__typename": "CodeSnippetNode"
            },
            {
                "lang": "Python3",
                "langSlug": "python3",
                "code": "class Solution:\n    def maxResult(self, nums: List[int], k: int) -> int:\n        ",
                "__typename": "CodeSnippetNode"
            },
            {
                "lang": "C",
                "langSlug": "c",
                "code": "\n\nint maxResult(int* nums, int numsSize, int k){\n\n}",
                "__typename": "CodeSnippetNode"
            },
            {
                "lang": "C#",
                "langSlug": "csharp",
                "code": "public class Solution {\n    public int MaxResult(int[] nums, int k) {\n        \n    }\n}",
                "__typename": "CodeSnippetNode"
            },
            {
                "lang": "JavaScript",
                "langSlug": "javascript",
                "code": "/**\n * @param {number[]} nums\n * @param {number} k\n * @return {number}\n */\nvar maxResult = function(nums, k) {\n    \n};",
                "__typename": "CodeSnippetNode"
            },
            {
                "lang": "Ruby",
                "langSlug": "ruby",
                "code": "# @param {Integer[]} nums\n# @param {Integer} k\n# @return {Integer}\ndef max_result(nums, k)\n    \nend",
                "__typename": "CodeSnippetNode"
            },
            {
                "lang": "Swift",
                "langSlug": "swift",
                "code": "class Solution {\n    func maxResult(_ nums: [Int], _ k: Int) -> Int {\n        \n    }\n}",
                "__typename": "CodeSnippetNode"
            },
            {
                "lang": "Go",
                "langSlug": "golang",
                "code": "func maxResult(nums []int, k int) int {\n    \n}",
                "__typename": "CodeSnippetNode"
            },
            {
                "lang": "Scala",
                "langSlug": "scala",
                "code": "object Solution {\n    def maxResult(nums: Array[Int], k: Int): Int = {\n        \n    }\n}",
                "__typename": "CodeSnippetNode"
            },
            {
                "lang": "Kotlin",
                "langSlug": "kotlin",
                "code": "class Solution {\n    fun maxResult(nums: IntArray, k: Int): Int {\n        \n    }\n}",
                "__typename": "CodeSnippetNode"
            },
            {
                "lang": "Rust",
                "langSlug": "rust",
                "code": "impl Solution {\n    pub fn max_result(nums: Vec<i32>, k: i32) -> i32 {\n        \n    }\n}",
                "__typename": "CodeSnippetNode"
            },
            {
                "lang": "PHP",
                "langSlug": "php",
                "code": "class Solution {\n\n    /**\n     * @param Integer[] $nums\n     * @param Integer $k\n     * @return Integer\n     */\n    function maxResult($nums, $k) {\n        \n    }\n}",
                "__typename": "CodeSnippetNode"
            },
            {
                "lang": "TypeScript",
                "langSlug": "typescript",
                "code": "function maxResult(nums: number[], k: number): number {\n\n};",
                "__typename": "CodeSnippetNode"
            },
            {
                "lang": "Racket",
                "langSlug": "racket",
                "code": "(define/contract (max-result nums k)\n  (-> (listof exact-integer?) exact-integer? exact-integer?)\n\n  )",
                "__typename": "CodeSnippetNode"
            },
            {
                "lang": "Erlang",
                "langSlug": "erlang",
                "code": "-spec max_result(Nums :: [integer()], K :: integer()) -> integer().\nmax_result(Nums, K) ->\n  .",
                "__typename": "CodeSnippetNode"
            },
            {
                "lang": "Elixir",
                "langSlug": "elixir",
                "code": "defmodule Solution do\n  @spec max_result(nums :: [integer], k :: integer) :: integer\n  def max_result(nums, k) do\n\n  end\nend",
                "__typename": "CodeSnippetNode"
            }
        ],
        "stats": "{\"totalAccepted\": \"85.7K\", \"totalSubmission\": \"184.8K\", \"totalAcceptedRaw\": 85731, \"totalSubmissionRaw\": 184790, \"acRate\": \"46.4%\"}",
        "hints": [
            "Let dp[i] be \"the maximum score to reach the end starting at index i\". The answer for dp[i] is nums[i] + max{dp[i+j]} for 1 <= j <= k. That gives an O(n*k) solution.",
            "Instead of checking every j for every i, keep track of the largest dp[i] values in a heap and calculate dp[i] from right to left. When the largest value in the heap is out of bounds of the current index, remove it and keep checking."
        ],
        "solution": {
            "id": "1087",
            "canSeeDetail": true,
            "paidOnly": true,
            "hasVideoSolution": false,
            "paidOnlyVideo": true,
            "__typename": "ArticleNode"
        },
        "status": null,
        "sampleTestCase": "[1,-1,-2,4,-7,3]\n2",
        "metaData": "{\n  \"name\": \"maxResult\",\n  \"params\": [\n    {\n      \"name\": \"nums\",\n      \"type\": \"integer[]\"\n    },\n    {\n      \"type\": \"integer\",\n      \"name\": \"k\"\n    }\n  ],\n  \"return\": {\n    \"type\": \"integer\"\n  }\n}",
        "judgerAvailable": true,
        "judgeType": "large",
        "mysqlSchemas": [],
        "enableRunCode": true,
        "enableTestMode": false,
        "enableDebugger": true,
        "envInfo": "{\"cpp\": [\"C++\", \"<p>Compiled with <code> clang 11 </code> using the latest C++ 17 standard.</p>\\r\\n\\r\\n<p>Your code is compiled with level two optimization (<code>-O2</code>). <a href=\\\"https://github.com/google/sanitizers/wiki/AddressSanitizer\\\" target=\\\"_blank\\\">AddressSanitizer</a> is also enabled to help detect out-of-bounds and use-after-free bugs.</p>\\r\\n\\r\\n<p>Most standard library headers are already included automatically for your convenience.</p>\"], \"java\": [\"Java\", \"<p><code> OpenJDK 17 </code>. Java 8 features such as lambda expressions and stream API can be used. </p>\\r\\n\\r\\n<p>Most standard library headers are already included automatically for your convenience.</p>\\r\\n<p>Includes <code>Pair</code> class from https://docs.oracle.com/javase/8/javafx/api/javafx/util/Pair.html.</p>\"], \"python\": [\"Python\", \"<p><code>Python 2.7.12</code>.</p>\\r\\n\\r\\n<p>Most libraries are already imported automatically for your convenience, such as <a href=\\\"https://docs.python.org/2/library/array.html\\\" target=\\\"_blank\\\">array</a>, <a href=\\\"https://docs.python.org/2/library/bisect.html\\\" target=\\\"_blank\\\">bisect</a>, <a href=\\\"https://docs.python.org/2/library/collections.html\\\" target=\\\"_blank\\\">collections</a>. If you need more libraries, you can import it yourself.</p>\\r\\n\\r\\n<p>For Map/TreeMap data structure, you may use <a href=\\\"http://www.grantjenks.com/docs/sortedcontainers/\\\" target=\\\"_blank\\\">sortedcontainers</a> library.</p>\\r\\n\\r\\n<p>Note that Python 2.7 <a href=\\\"https://www.python.org/dev/peps/pep-0373/\\\" target=\\\"_blank\\\">will not be maintained past 2020</a>. For the latest Python, please choose Python3 instead.</p>\"], \"c\": [\"C\", \"<p>Compiled with <code>gcc 8.2</code> using the gnu11 standard.</p>\\r\\n\\r\\n<p>Your code is compiled with level one optimization (<code>-O1</code>). <a href=\\\"https://github.com/google/sanitizers/wiki/AddressSanitizer\\\" target=\\\"_blank\\\">AddressSanitizer</a> is also enabled to help detect out-of-bounds and use-after-free bugs.</p>\\r\\n\\r\\n<p>Most standard library headers are already included automatically for your convenience.</p>\\r\\n\\r\\n<p>For hash table operations, you may use <a href=\\\"https://troydhanson.github.io/uthash/\\\" target=\\\"_blank\\\">uthash</a>. \\\"uthash.h\\\" is included by default. Below are some examples:</p>\\r\\n\\r\\n<p><b>1. Adding an item to a hash.</b>\\r\\n<pre>\\r\\nstruct hash_entry {\\r\\n    int id;            /* we'll use this field as the key */\\r\\n    char name[10];\\r\\n    UT_hash_handle hh; /* makes this structure hashable */\\r\\n};\\r\\n\\r\\nstruct hash_entry *users = NULL;\\r\\n\\r\\nvoid add_user(struct hash_entry *s) {\\r\\n    HASH_ADD_INT(users, id, s);\\r\\n}\\r\\n</pre>\\r\\n</p>\\r\\n\\r\\n<p><b>2. Looking up an item in a hash:</b>\\r\\n<pre>\\r\\nstruct hash_entry *find_user(int user_id) {\\r\\n    struct hash_entry *s;\\r\\n    HASH_FIND_INT(users, &user_id, s);\\r\\n    return s;\\r\\n}\\r\\n</pre>\\r\\n</p>\\r\\n\\r\\n<p><b>3. Deleting an item in a hash:</b>\\r\\n<pre>\\r\\nvoid delete_user(struct hash_entry *user) {\\r\\n    HASH_DEL(users, user);  \\r\\n}\\r\\n</pre>\\r\\n</p>\"], \"csharp\": [\"C#\", \"<p><a href=\\\"https://docs.microsoft.com/en-us/dotnet/csharp/whats-new/csharp-9\\\" target=\\\"_blank\\\">C# 10 with .NET 6 runtime</a></p>\"], \"javascript\": [\"JavaScript\", \"<p><code>Node.js 16.13.2</code>.</p>\\r\\n\\r\\n<p>Your code is run with <code>--harmony</code> flag, enabling <a href=\\\"http://node.green/\\\" target=\\\"_blank\\\">new ES6 features</a>.</p>\\r\\n\\r\\n<p><a href=\\\"https://lodash.com\\\" target=\\\"_blank\\\">lodash.js</a> library is included by default.</p>\\r\\n\\r\\n<p>For Priority Queue / Queue data structures, you may use <a href=\\\"https://github.com/datastructures-js/priority-queue\\\" target=\\\"_blank\\\">datastructures-js/priority-queue</a> and <a href=\\\"https://github.com/datastructures-js/queue\\\" target=\\\"_blank\\\">datastructures-js/queue</a>.</p>\"], \"ruby\": [\"Ruby\", \"<p><code>Ruby 3.1</code></p>\\r\\n\\r\\n<p>Some common data structure implementations are provided in the Algorithms module: https://www.rubydoc.info/github/kanwei/algorithms/Algorithms</p>\"], \"swift\": [\"Swift\", \"<p><code>Swift 5.5.2</code>.</p>\"], \"golang\": [\"Go\", \"<p><code>Go 1.17.6</code>.</p>\\r\\n\\r\\n<p>Support <a href=\\\"https://godoc.org/github.com/emirpasic/gods\\\" target=\\\"_blank\\\">https://godoc.org/github.com/emirpasic/gods</a> library.</p>\"], \"python3\": [\"Python3\", \"<p><code>Python 3.10</code>.</p>\\r\\n\\r\\n<p>Most libraries are already imported automatically for your convenience, such as <a href=\\\"https://docs.python.org/3/library/array.html\\\" target=\\\"_blank\\\">array</a>, <a href=\\\"https://docs.python.org/3/library/bisect.html\\\" target=\\\"_blank\\\">bisect</a>, <a href=\\\"https://docs.python.org/3/library/collections.html\\\" target=\\\"_blank\\\">collections</a>. If you need more libraries, you can import it yourself.</p>\\r\\n\\r\\n<p>For Map/TreeMap data structure, you may use <a href=\\\"http://www.grantjenks.com/docs/sortedcontainers/\\\" target=\\\"_blank\\\">sortedcontainers</a> library.</p>\"], \"scala\": [\"Scala\", \"<p><code>Scala 2.13.7</code>.</p>\"], \"kotlin\": [\"Kotlin\", \"<p><code>Kotlin 1.3.10</code>.</p>\"], \"rust\": [\"Rust\", \"<p><code>Rust 1.58.1</code></p>\\r\\n\\r\\n<p>Supports <a href=\\\"https://crates.io/crates/rand\\\" target=\\\"_blank\\\">rand </a> v0.6\\u00a0from crates.io</p>\"], \"php\": [\"PHP\", \"<p><code>PHP 8.1</code>.</p>\\r\\n<p>With bcmath module</p>\"], \"typescript\": [\"Typescript\", \"<p><code>TypeScript 4.5.4, Node.js 16.13.2</code>.</p>\\r\\n\\r\\n<p>Your code is run with <code>--harmony</code> flag, enabling <a href=\\\"http://node.green/\\\" target=\\\"_blank\\\">new ES2020 features</a>.</p>\\r\\n\\r\\n<p><a href=\\\"https://lodash.com\\\" target=\\\"_blank\\\">lodash.js</a> library is included by default.</p>\"], \"racket\": [\"Racket\", \"<p>Run with <code>Racket 8.3</code>.</p>\"], \"erlang\": [\"Erlang\", \"Erlang/OTP 24.2\"], \"elixir\": [\"Elixir\", \"Elixir 1.13.0 with Erlang/OTP 24.2\"]}",
        "libraryUrl": null,
        "adminUrl": null,
        "challengeQuestion": {
            "id": "979",
            "date": "2022-07-09",
            "incompleteChallengeCount": 14,
            "streakCount": 0,
            "type": "DAILY",
            "__typename": "ChallengeQuestionNode"
        },
        "__typename": "QuestionNode"
    },
    "solution": {
        "id": "1087",
        "content": "[TOC]\n\n## Solution\n\n---\n\n#### Overview\n\nYou probably can guess from the problem title, this is the sixth problem in the series of [Jump Game](https://leetcode.com/problems/jump-game/) problems. Those problems are similar, but have considerable differences, making their solutions quite different.\n\nIn this problem, for each move, we are allowed to advance `k` steps, and our target is to maximize the scores we collect.\n\nOne example:\n\n![Figure 0.1](../Documents/5631/5631_0_1.drawio.svg)\n\nBelow, five approaches are introduced.\n\nGenerally, we recommend *Approach 1: Dynamic Programming + Deque* and *Approach 4: Dynamic Programming + Deque (Compressed)* since they have the best performance.\n\nAlso, because it is a medium level problem, we allow some relevant slower approaches: *Approach 2: Dynamic Programming + Priority Queue* and *Approach 3: Segment Tree*.\n\nNote that *Approach 4: Dynamic Programming + Deque (Compressed)* and *Approach 5: Dynamic Programming + Priority Queue (Compressed)* are the state compressed version of *Approach 1* and *Approach 2*.\n\n---\n\n#### Approach 1: Dynamic Programming + Deque\n\n**Intuition**\n\n> Note: This approach is a little bit **beyond** the medium level question, so if you are struggling to understand this, you should at least finish the DP part, and then feel free to jump to *Approach 2* , which is easier but has a slower performance.\n> \n> However, it is still strongly recommended to understand this whole approach since it is not that hard.\n\n>In this part, we will explain how to think of this approach step by step.\n>\n>If you are only interested in the pure algorithm, you can jump to the algorithm part.\n\nFor the Jump Game series questions, dynamic programming is our old friend. It's natural to try DP first.\n\nTo implement DP, we need a dp array. What should the DP array represent?\n\nSince the problem ask us the max score we can get ending at the last index, how about letting `dp[i]` represent the max score we can get ending at index `i`?\n\n> Also, you can let `dp[i]` represent the max score we can get **starting** at index `i`. That is similar.\n\nTo have better naming, we rename `dp` to `score`. So, `score[i]` represents the max score we can get ending at index `i`.\n\nFor example:\n\n![Figure 1.1](../Documents/5631/5631_1_1.drawio.svg)\n\nOK. Let's dive deeper.\n\nFor a DP solution, basically, we need two things:\n\n1. The base case.\n   \nThis is where our dp start. Usually, this means how to calculate `dp[0]`. In our case, `score[0] = nums[0]` since `nums[0]` is both our start and end. We only have one choice.\n\n2. The so-called transition equation.\n   \nThat is to say, if we have already calculated `score[0]`, `score[1]`, ..., `score[i-1]`, how can we calculate `score[i]`? \n\nSince we can only advance `k` steps, to arrive `nums[i]`, we must jump from one of `nums[i-k]`, `nums[i-k+1]`, ..., `nums[i-1]`. We only need to pick the one with maximum `score`.\n\nFor example, if we are calculating `score[3]` and `k=3`, we need to decide jump from index `0`, `1`, or `2`:\n\n![Figure 1.2](../Documents/5631/5631_1_2.drawio.svg)\n\nOK, now we have a transition equation:\n\n```\nscore[i] = max(score[i-k], ..., score[i-1]) + nums[i]\n```\n\nHowever, this equation needs $$\\mathcal{O}(k)$$ to calculate `score[i]`, which makes the overall complexity come to $$\\mathcal{O}(Nk) = 10^{9}$$ in the worst case, given that $$N$$ is the length of `nums`.\n\nThis complexity is too much and we need to improve it.\n\nSomehow, this equation is similar to [Sliding Window Maximum](https://leetcode.com/problems/sliding-window-maximum/), which is a typical monotonic queue problem. We can use the same technique to make some improvements.\n\nNote that when calculating maximum, we do not need all `score[i-k]`, ..., `score[i-1]`; we just need some large values.\n\nFor example, if `k == 3` and `[score[i-3], score[i-2], score[i-1]] = [2, 4, 10]`, their maximum is `score[i-1] = 10`. In this case, when calculating following `score[i]` (and further `score[i+1]`), we do **not** need `score[i-3] = 2` and `score[i-2] = 4`, since they are smaller than `score[i-1] = 10`.\n\nThe picture illustrates another example when calculating `score[2]`:\n\n![Figure 1.3](../Documents/5631/5631_1_3.drawio.svg)\n\nIn this case, we maintain a deque as a monotonically decreasing queue. Since it is monotonically decreasing, the maximum value is always at the **top** of the queue.\n\nIn practice, since we store scores in `score`, we only need to store the index in the queue.\n\nAlso, remember to pop the index smaller than `i-k` out of the queue from the left.\n\n**Algorithm**\n\n*Step 1:* Initialize a dp array `score`, where `score[i]` represents the max score starting at `nums[0]` and ending at `nums[i]`.\n\n*Step 2:* Initialize a deque array `dq` storing indexes of `nums` such that the corresponding values are monotonically decreasing.\n\n*Step 3:* Iterate over `nums`. For each element `nums[i]`:\n  - Pop all the indexes smaller than `i-k` out of `dq` from left.\n  - Update `score[i]` to `score[dq.peekFirst()] + nums[i]`.\n  - If the corresponding score of the rightmost index in `dq` (i.e., `score[dq.peekLast()]`) is smaller than `score[i]`, pop it from the right to make corresponding values monotonically decreasing. Repeat.\n  - Push `i` into the right of `dq`.\n\n*Step 4:* Return the last element of `score`.\n\n> Challenge: Can you implement the code yourself without seeing our implementations?\n\n**Implementation**\n\n<iframe src=\"https://leetcode.com/playground/NdQBmiMG/shared\" frameBorder=\"0\" width=\"100%\" height=\"446\" name=\"NdQBmiMG\"></iframe>\n\n**Complexity Analysis**\n\nLet $$N$$ be the length of `nums`.\n\n* Time Complexity: $$\\mathcal{O}(N)$$, since we need to iterate `nums`, and push and pop each element into the deque at most once.\n\n* Space Complexity: $$\\mathcal{O}(N)$$, since we need $$\\mathcal{O}(N)$$ space to store our dp array and $$\\mathcal{O}(k)$$ to store `dq`.\n\n---\n\n#### Approach 2: Dynamic Programming + Priority Queue\n\n**Intuition**\n\nIn *Approach 1*, we got the following transition equation for Dynamic Programming:\n\n```\nscore[i] = max(score[i-k], ..., score[i-1]) + nums[i]\n```\n\nIf you are not familiar with the monotonic queue technique mentioned in *Approach 1*, and still want to find out the maximum quickly, Priority Queue (Heap) is for you. Heap maintain and return the max value in $$\\log$$ time.\n\n![Figure 2.1](../Documents/5631/5631_2_1.drawio.svg)\n\nIf we found that the index of the maximum score is less than `i-k`, just pop out and get the next maximum score.\n\n**Algorithm**\n\n*Step 1:* Initialize a dp array `score`, where `score[i]` represents the max score starting at `nums[0]` and ending at `nums[i]`.\n\n*Step 2:* Initialize a max-heap `priority_queue`.\n\n*Step 3:* Iterate over `nums`. For each element `nums[i]`:\n  - If the index of top of `priority_queue` is less than `i-k`, pop the top. Repeat.\n  - Update `score[i]` to the sum of corresponding score of the index of top of `priority_queue` and `nums[i]` (i.e., `score[priorityQueue.peek()[1]] + nums[i]`).\n  - Push pair `(score[i], i)` into `priority_queue`.\n\n*Step 4:* Return the last element of `score`.\n\n> Challenge: Can you implement the code yourself without seeing our implementations?\n\n**Implementation**\n\n<iframe src=\"https://leetcode.com/playground/8JUeiNk5/shared\" frameBorder=\"0\" width=\"100%\" height=\"395\" name=\"8JUeiNk5\"></iframe>\n\n**Complexity Analysis**\n\nLet $$N$$ be the length of `nums`.\n\n* Time Complexity: $$\\mathcal{O}(N \\log N)$$, since we need to iterate `nums`, and push and pop each element into the deque at most once, and for each push and pop, it costs $$\\mathcal{O}(\\log N)$$ in the worst case.\n\n* Space Complexity: $$\\mathcal{O}(N)$$, since we need $$\\mathcal{O}(N)$$ space to store our dp array and $$\\mathcal{O}(N)$$ to store `priority_queue`.\n\n---\n\n#### Approach 3: Segment Tree\n\n**Intuition**\n\nIn *Approach 1*, we got the following transition equation for Dynamic Programming:\n\n```\nscore[i] = max(score[i-k], ..., score[i-1]) + nums[i]\n```\n\nThere is also another way to find out the interval maximum in $$\\log$$ time: Segment Tree.\n\nSince we already have some great explanations on [Segment Tree](https://en.wikipedia.org/wiki/Segment_tree), here we will **not** provide a detailed explanation of implementation. You can find some comprehensive tutorials on [Recursive Approach to Segment Trees](https://leetcode.com/articles/a-recursive-approach-to-segment-trees-range-sum-queries-lazy-propagation/) or [Range Sum Query - Mutable](https://leetcode.com/problems/range-sum-query-mutable/solution/).\n\nNow, we will have a quick review of the segment tree and then explain how we can use it to tackle our problem.\n\nAs we know, the segment tree is a data structure used for storing information about intervals. Given that $$N$$ is the size of the tree, this data structure allows us to `query` and to `update` the information about a certain interval in $$\\mathcal{O}(\\log(N))$$ time.\n\nTake the segment tree for querying interval **max** for an example:\n\n![Figure 3.1](../Documents/5631/5631_3_1.drawio.svg)\n\nUsually, we store the tree in an array. We need twice the size of the original array to store the segment tree.\n\nHere, we leave the index `0` unused for the convenience of indexing. You can also choose to use it by shifting the whole tree to left by one unit. In our approach, the left and right children of node `i` are `2*i` and `2*i + 1` respectively.\n\nGiven that `n` is the size of the original array, from the node `n` to node `2*n - 1`, we store the original array itself. For other nodes, we store the value of node `i` as the sum of node `2*i` and node `2*i + 1`.\n\nThe segment tree allows us to `query` the **max** of a certain interval and to `update` the values of elements. It should be able to process both actions in $$\\mathcal{O}(\\log(N))$$ time. Let's see some examples.\n\n*Updating Value*\n\nFor `update`, what we do is simple. Just update the value from the leaf to the root. For instance:\n\n![Figure 3.2](../Documents/5631/5631_3_2.drawio.svg)\n\n*Querying Sum*\n\nFor `query`, the case is a bit complicated. Generally speaking, we are dividing the target interval into a few pre-calculated segments to reduced run time. For example:\n\n![Figure 3.3](../Documents/5631/5631_3_3.drawio.svg)\n\nOK. Now back to our problem. How can we use the segment tree?\n\nFor each element `nums[i]`, we need to `query` `max(score[i-k], ..., score[i-1])`, and then `update` the value of index `i` in Segment Tree to that maximum plus `nums[i]`. Both actions can be implemented in $$\\log$$ time.\n\n**Algorithm**\n\n*Step 1:* Implement the Segment Tree. Since the tree is initialized to all zeros, only `update` and `query` need to be implemented.\n\n*Step 2:* Iterate over `nums`. For each element `nums[i]`:\n  - `query` the maximum from index `i-k` to index `i`.\n  - `update` value of index `i` to that maximum plus `nums[i]`.\n\n*Step 3:* Return the last element of the segment tree.\n\n> Challenge: Can you implement the code yourself without seeing our implementations?\n\n**Implementation**\n\n<iframe src=\"https://leetcode.com/playground/7FtTpWMm/shared\" frameBorder=\"0\" width=\"100%\" height=\"500\" name=\"7FtTpWMm\"></iframe>\n\n**Complexity Analysis**\n\nLet $$N$$ be the length of `nums`.\n\n* Time Complexity: $$\\mathcal{O}(N \\log N)$$, since we need to iterate `nums`, and for each element we need to perform the `query` and `update` once, which costs $$\\mathcal{O}(\\log N)$$ in the worst case.\n\n* Space Complexity: $$\\mathcal{O}(N)$$, since we need $$\\mathcal{O}(N)$$ space to store our segment tree.\n\n---\n\n#### Approach 4: Dynamic Programming + Deque (Compressed)\n\n**Intuition**\n\nNote that in *Approach 1*, when calculating `score[i]`, we do not need all values from `score[0]` to `score[i-1]`; we only need part of values from `score[i-k]` to `score[i-1]`. We can drop the previous values to save memory.\n\nBut how? Note that we have a deque array `dq`, we can save `score[i]` when saving index `i`, and drop the whole `score` array. That is to say, we save a pair `(i, score[i])` in the deque. The length of `dq` is at most $$\\mathcal{O}(k)$$, so the space complexity is down to $$\\mathcal{O}(k)$$.\n\n**Algorithm**\n\n*Step 1:* Initialize an integer `score`.\n\n*Step 2:* Initialize a deque array `dq`.\n\n*Step 3:* Iterate over `nums`. For each element `nums[i]`:\n  - Pop all the indexes smaller than `i-k` out of `dq` from left.\n  - Update `score` to `dq.peekFirst()[1] + nums[i]`.\n  - If the corresponding score of the rightmost index in `dq` (i.e., `dq.peekLast()[1]`) is smaller than `score`, pop it from the right to make corresponding values monotonically decreasing. Repeat.\n  - Push `(i, score)` into the right of `dq`.\n\n*Step 4:* Return `score`.\n\n> Challenge: Can you implement the code yourself without seeing our implementations?\n\n**Implementation**\n\n<iframe src=\"https://leetcode.com/playground/kw4t3yup/shared\" frameBorder=\"0\" width=\"100%\" height=\"412\" name=\"kw4t3yup\"></iframe>\n\n**Complexity Analysis**\n\nLet $$N$$ be the length of `nums`.\n\n* Time Complexity: $$\\mathcal{O}(N)$$, since we need to iterate `nums`, and push and pop each element into the deque at most once.\n\n* Space Complexity: $$\\mathcal{O}(k)$$, since we need $$\\mathcal{O}(k)$$ to store `dq`.\n\n---\n\n#### Approach 5: Dynamic Programming + Priority Queue (Compressed)\n\n**Intuition**\n\nSimilar to *Approach 4*, when calculating `score[i]`, we do not need all values from `score[0]` to `score[i-1]`; we only need values from `score[i-k]` to `score[i-1]`. We can drop the previous values to save memory.\n\nSince we already save the `(score[i], i)` pair in our Priority Queue, we can directly drop the `score` array.\n\nHowever, the length of our Priority Queue is $$\\mathcal{O}(N)$$ in the worst case, given that $$N$$ is the length of `nums`. That is to say, we can not decrease the big-O space complexity. Nevertheless, we still decrease memory usage by half by dropping the `score` array.\n\n**Algorithm**\n\n*Step 1:* Initialize an integer `score`.\n\n*Step 2:* Initialize a max-heap `priority_queue`.\n\n*Step 3:* Iterate over `nums`. For each element `nums[i]`:\n  - If the index of top of `priority_queue` is less than `i-k`, pop the top. Repeat.\n  - Update `score` to the sum of corresponding score of the index of top of `priority_queue` and `nums[i]` (i.e., `priorityQueue.peek()[0] + nums[i]`).\n  - Push pair `(score, i)` into `priority_queue`.\n\n*Step 4:* Return `score`.\n\n> Challenge: Can you implement the code yourself without seeing our implementations?\n\n**Implementation**\n\n<iframe src=\"https://leetcode.com/playground/fsKbvhPB/shared\" frameBorder=\"0\" width=\"100%\" height=\"361\" name=\"fsKbvhPB\"></iframe>\n\n**Complexity Analysis**\n\nLet $$N$$ be the length of `nums`.\n\n* Time Complexity: $$\\mathcal{O}(N \\log N)$$, since we need to iterate `nums`, and push and pop each element into the deque at most once, and for each push and pop, it costs $$\\mathcal{O}(\\log N)$$ in the worst case.\n\n* Space Complexity: $$\\mathcal{O}(N)$$, since we need $$\\mathcal{O}(N)$$ to store `priority_queue`.",
        "contentTypeId": "107",
        "canSeeDetail": true,
        "paidOnly": true,
        "hasVideoSolution": false,
        "paidOnlyVideo": true,
        "rating": {
            "id": "1042",
            "count": 80,
            "average": "4.525",
            "userRating": null,
            "__typename": "RatingNode"
        },
        "__typename": "ArticleNode"
    },
    "questionCode": "jump-game-vi",
    "playgroundData": {
        "NdQBmiMG": {
            "playground": {
                "testcaseInput": "",
                "name": "jump-game-vi-4",
                "isUserOwner": false,
                "isLive": false,
                "showRunCode": false,
                "showOpenInPlayground": false,
                "selectedLangSlug": "cpp",
                "isShared": true,
                "__typename": "PlaygroundNode"
            },
            "allPlaygroundCodes": [
                {
                    "code": "class Solution {\n    public int[] twoSum(int[] nums, int target) {\n        for (int i = 0; i < nums.length; i++) {\n            for (int j = i + 1; j < nums.length; j++) {\n                if (nums[j] == target - nums[i]) {\n                    return new int[] { i, j };\n                }\n            }\n        }\n        // In case there is no solution, we'll just return null\n        return null;\n    }\n}",
                    "langSlug": "java",
                    "__typename": "PlaygroundCodeNode"
                },
                {
                    "code": "class Solution:\n    def twoSum(self, nums: List[int], target: int) -> List[int]:\n        for i in range(len(nums)):\n            for j in range(i + 1, len(nums)):\n                if nums[j] == target - nums[i]:\n                    return [i, j]",
                    "langSlug": "python3",
                    "__typename": "PlaygroundCodeNode"
                }
            ]
        },
        "8JUeiNk5": {
            "playground": {
                "testcaseInput": "",
                "name": "jump-game-vi-3",
                "isUserOwner": false,
                "isLive": false,
                "showRunCode": false,
                "showOpenInPlayground": false,
                "selectedLangSlug": "cpp",
                "isShared": true,
                "__typename": "PlaygroundNode"
            },
            "allPlaygroundCodes": [
                {
                    "code": "class Solution {\n    public int[] twoSum(int[] nums, int target) {\n        for (int i = 0; i < nums.length; i++) {\n            for (int j = i + 1; j < nums.length; j++) {\n                if (nums[j] == target - nums[i]) {\n                    return new int[] { i, j };\n                }\n            }\n        }\n        // In case there is no solution, we'll just return null\n        return null;\n    }\n}",
                    "langSlug": "java",
                    "__typename": "PlaygroundCodeNode"
                },
                {
                    "code": "class Solution:\n    def twoSum(self, nums: List[int], target: int) -> List[int]:\n        for i in range(len(nums)):\n            for j in range(i + 1, len(nums)):\n                if nums[j] == target - nums[i]:\n                    return [i, j]",
                    "langSlug": "python3",
                    "__typename": "PlaygroundCodeNode"
                }
            ]
        },
        "7FtTpWMm": {
            "playground": {
                "testcaseInput": "",
                "name": "jump-game-vi-2",
                "isUserOwner": false,
                "isLive": false,
                "showRunCode": false,
                "showOpenInPlayground": false,
                "selectedLangSlug": "cpp",
                "isShared": true,
                "__typename": "PlaygroundNode"
            },
            "allPlaygroundCodes": [
                {
                    "code": "class Solution {\n    public int[] twoSum(int[] nums, int target) {\n        for (int i = 0; i < nums.length; i++) {\n            for (int j = i + 1; j < nums.length; j++) {\n                if (nums[j] == target - nums[i]) {\n                    return new int[] { i, j };\n                }\n            }\n        }\n        // In case there is no solution, we'll just return null\n        return null;\n    }\n}",
                    "langSlug": "java",
                    "__typename": "PlaygroundCodeNode"
                },
                {
                    "code": "class Solution:\n    def twoSum(self, nums: List[int], target: int) -> List[int]:\n        for i in range(len(nums)):\n            for j in range(i + 1, len(nums)):\n                if nums[j] == target - nums[i]:\n                    return [i, j]",
                    "langSlug": "python3",
                    "__typename": "PlaygroundCodeNode"
                }
            ]
        },
        "kw4t3yup": {
            "playground": {
                "testcaseInput": "",
                "name": "jump-game-vi-1",
                "isUserOwner": false,
                "isLive": false,
                "showRunCode": false,
                "showOpenInPlayground": false,
                "selectedLangSlug": "cpp",
                "isShared": true,
                "__typename": "PlaygroundNode"
            },
            "allPlaygroundCodes": [
                {
                    "code": "class Solution {\n    public int[] twoSum(int[] nums, int target) {\n        for (int i = 0; i < nums.length; i++) {\n            for (int j = i + 1; j < nums.length; j++) {\n                if (nums[j] == target - nums[i]) {\n                    return new int[] { i, j };\n                }\n            }\n        }\n        // In case there is no solution, we'll just return null\n        return null;\n    }\n}",
                    "langSlug": "java",
                    "__typename": "PlaygroundCodeNode"
                },
                {
                    "code": "class Solution:\n    def twoSum(self, nums: List[int], target: int) -> List[int]:\n        for i in range(len(nums)):\n            for j in range(i + 1, len(nums)):\n                if nums[j] == target - nums[i]:\n                    return [i, j]",
                    "langSlug": "python3",
                    "__typename": "PlaygroundCodeNode"
                }
            ]
        },
        "fsKbvhPB": {
            "playground": {
                "testcaseInput": "",
                "name": "jump-game-vi-0",
                "isUserOwner": false,
                "isLive": false,
                "showRunCode": false,
                "showOpenInPlayground": false,
                "selectedLangSlug": "cpp",
                "isShared": true,
                "__typename": "PlaygroundNode"
            },
            "allPlaygroundCodes": [
                {
                    "code": "class Solution {\n    public int[] twoSum(int[] nums, int target) {\n        for (int i = 0; i < nums.length; i++) {\n            for (int j = i + 1; j < nums.length; j++) {\n                if (nums[j] == target - nums[i]) {\n                    return new int[] { i, j };\n                }\n            }\n        }\n        // In case there is no solution, we'll just return null\n        return null;\n    }\n}",
                    "langSlug": "java",
                    "__typename": "PlaygroundCodeNode"
                },
                {
                    "code": "class Solution:\n    def twoSum(self, nums: List[int], target: int) -> List[int]:\n        for i in range(len(nums)):\n            for j in range(i + 1, len(nums)):\n                if nums[j] == target - nums[i]:\n                    return [i, j]",
                    "langSlug": "python3",
                    "__typename": "PlaygroundCodeNode"
                }
            ]
        }
    }
}